import{s as Se,n as Q,d as L,l as Ee,r as Re,m as ie,i as oe,b as C,o as H,p as U,q as Ce,u as z,c as F,e as Y,g as q,v as W,h as T,j as K,w as De,x as Ie,f as Be,t as Pe,y as Fe}from"../chunks/DweVjaGk.js";import{e as ne}from"../chunks/-gASlQSi.js";import{S as Te,i as Ue}from"../chunks/BA73HWMz.js";import{c as ze}from"../chunks/BFb7JJa7.js";import{FFmpeg as Le}from"@ffmpeg/ffmpeg";import{toBlobURL as G}from"@ffmpeg/util";function se(f,a,y){const i=f.slice();return i[39]=a[y],i}function re(f){let a,y=f[39].name+"",i;return{c(){a=T("option"),i=Pe(y),this.h()},l(h){a=F(h,"OPTION",{});var s=Y(a);i=Be(s,y),s.forEach(L),this.h()},h(){a.__value=f[39].id,Ie(a,a.__value)},m(h,s){oe(h,a,s),C(a,i)},p:Q,d(h){h&&L(a)}}}function Ae(f){let a,y,i,h,s,t='<canvas id="my_canvas" style="width: 300px; height: 300px;" class="bg-white border-blue-500 border-opacity-50 border-8 rounded-2xl overflow-clip"></canvas>',_,b,x,A="Start Recording",I,p,u="Stop & Export",w,E,v=ne(f[1]),c=[];for(let r=0;r<v.length;r+=1)c[r]=re(se(f,v,r));return{c(){a=T("div"),y=T("div"),i=T("select");for(let r=0;r<c.length;r+=1)c[r].c();h=K(),s=T("div"),s.innerHTML=t,_=K(),b=T("div"),x=T("button"),x.textContent=A,I=K(),p=T("button"),p.textContent=u,this.h()},l(r){a=F(r,"DIV",{style:!0,class:!0});var d=Y(a);y=F(d,"DIV",{class:!0});var o=Y(y);i=F(o,"SELECT",{class:!0});var B=Y(i);for(let D=0;D<c.length;D+=1)c[D].l(B);B.forEach(L),o.forEach(L),h=q(d),s=F(d,"DIV",{style:!0,class:!0,"data-svelte-h":!0}),W(s)!=="svelte-4jyi7t"&&(s.innerHTML=t),_=q(d),b=F(d,"DIV",{class:!0});var k=Y(b);x=F(k,"BUTTON",{class:!0,"data-svelte-h":!0}),W(x)!=="svelte-1duh8y7"&&(x.textContent=A),I=q(k),p=F(k,"BUTTON",{class:!0,"data-svelte-h":!0}),W(p)!=="svelte-ykajks"&&(p.textContent=u),k.forEach(L),d.forEach(L),this.h()},h(){U(i,"class","px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"),f[0]===void 0&&Ce(()=>f[4].call(i)),U(y,"class","mb-4"),z(s,"margin-top","75px"),z(s,"transform-origin","top center"),U(s,"class","flex justify-center items-center relative"),U(x,"class","px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition-colors"),U(p,"class","px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 transition-colors"),U(b,"class","mt-4 flex gap-4"),z(a,"transform-origin","top center"),z(a,"position","relative"),z(a,"margin-top","0"),z(a,"width","100%"),z(a,"padding","0 5rem"),U(a,"class","w-full flex justify-center items-center flex-col")},m(r,d){oe(r,a,d),C(a,y),C(y,i);for(let o=0;o<c.length;o+=1)c[o]&&c[o].m(i,null);ie(i,f[0],!0),C(a,h),C(a,s),C(a,_),C(a,b),C(b,x),C(b,I),C(b,p),w||(E=[H(i,"change",f[4]),H(x,"click",f[2]),H(p,"click",f[3])],w=!0)},p(r,d){if(d[0]&2){v=ne(r[1]);let o;for(o=0;o<v.length;o+=1){const B=se(r,v,o);c[o]?c[o].p(B,d):(c[o]=re(B),c[o].c(),c[o].m(i,null))}for(;o<c.length;o+=1)c[o].d(1);c.length=v.length}d[0]&3&&ie(i,r[0])},i:Q,o:Q,d(r){r&&L(a),Ee(c,r),w=!1,Re(E)}}}const J="https://unpkg.com/@ffmpeg/core-mt@0.12.6/dist/esm";function le(f){return f<.5?2*f*f:-1+(4-2*f)*f}function O(f,a,y,i){const h=1-i;return h*h*f+2*h*i*a+i*i*y}function je(f,a,y){let i=0,h=0,s,t,_,b=0,x=!1,A,I=!1,p="ripple",u=1,w=0,E=[],v=0,c=0,r={x:0,y:0},d={x:0,y:0},o=null;const B=[{id:"ripple",name:"Ripple Effect"},{id:"twinkle",name:"Twinkle Click"},{id:"shift-bounce",name:"Shift Bounce"}];let k=[];const D=new Le,P=[];De(async()=>{await ye(),await ve(),ce()});function ce(){s.addEventListener("click",e=>{if(!I)return;const n=s.getBoundingClientRect(),l=s.width/n.width,m=s.height/n.height;i=(e.clientX-n.left)*l,h=(e.clientY-n.top)*m,Z(i,h)})}function Z(e,n){switch(p){case"ripple":fe(e,n);break;case"twinkle":he(e,n);break;case"shift-bounce":ue(e,n);break}}function fe(e,n){u=.78,w=0,o={x:e,y:n}}function he(e,n){u=.85,w=0;const l=50,m=.08,M=7,S=-3*Math.PI/4+10*Math.PI/180,R=S-Math.PI/2,g=(S+Math.PI/2-R)/(M-1),V=e-l/2,X=n-l/2;for(let N=0;N<M;N++){const $=R+N*g,xe=V+Math.cos($)*m,be=X+Math.sin($)*m,ke=Math.cos($),Me=Math.sin($);k.push({x:xe,y:be,vx:ke,vy:Me,life:1,color:"#ffe600",size:4+Math.random()*1.5,type:"twinkle",headDist:m,tailDist:m,maxDist:38+Math.random()*10,tailProgress:0})}}function ue(e,n){v=1,c=0,r={x:e,y:n},d={x:e-16,y:n-16},u=1,E=[]}function de(){k=k.filter(e=>{switch(e.type){case"ripple":e.size+=2,e.life-=.02;break;case"twinkle":{e.headDist<e.maxDist?e.headDist+=1.35:e.tailDist<e.headDist&&(e.tailDist+=1.35*1.1),e.life-=.018,e.size*=.985;break}}return e.life>0})}function me(){k.forEach(e=>{if(t.globalAlpha=e.life,e.type==="ripple")t.beginPath(),t.arc(e.x,e.y,e.size,0,Math.PI*2),t.strokeStyle=e.color,t.lineWidth=2,t.stroke();else if(e.type==="twinkle"){const l=i-25,m=h-50/2,M=l+e.vx*e.headDist,S=m+e.vy*e.headDist,R=l+e.vx*Math.min(e.tailDist,e.headDist),j=m+e.vy*Math.min(e.tailDist,e.headDist);t.save(),t.strokeStyle=e.color,t.lineWidth=e.size,t.beginPath(),t.moveTo(R,j),t.lineTo(M,S),t.shadowColor=e.color,t.shadowBlur=10,t.stroke(),t.shadowBlur=0,t.restore()}else t.beginPath(),t.arc(e.x,e.y,e.size,0,Math.PI*2),t.fillStyle=e.color,t.fill()}),t.globalAlpha=1,t.shadowBlur=0}function ee(){E.forEach(e=>{e.radius+=1.5,e.alpha-=.025,e.frame++}),E=E.filter(e=>e.alpha>.05)}function te(){E.forEach(e=>{t.save(),t.globalAlpha=e.alpha,t.beginPath(),t.arc(e.x,e.y,e.radius,0,Math.PI*2),t.lineWidth=6,t.strokeStyle="#4a5568",t.stroke(),t.restore()})}function ae(){if(!I)return;t.clearRect(0,0,s.width,s.height);let e=i,n=h,l=50*u;if(p==="shift-bounce"&&v>0){c++;const m={x:r.x-40,y:r.y+24},M={x:d.x+56,y:d.y+48},S=48,R=24,j=56;if(v===1){let g=Math.min(1,c/S);g=le(g),e=O(r.x,m.x,d.x,g),n=O(r.y,m.y,d.y,g),g>=1&&(v=2,c=0,u=.78)}else if(v===2){if(e=d.x,n=d.y,l=50*u,w++,w<R*.4?u=.7:w<R*.75?u=.88:u=1,c===R){const g=e-l/2,V=n-l/2;E=[];for(let X=0;X<2;X++)E.push({x:g,y:V,radius:18+X*14,alpha:1,frame:0});v=3,c=0}}else if(v===3){let g=Math.min(1,c/j);g=le(g),e=O(d.x,M.x,r.x,g),n=O(d.y,M.y,r.y,g),l=50*(.92+.08*g),ee(),te(),g>=1&&(v=0)}t.drawImage(_,e-l/2,n-l/2,l,l),v===3&&(ee(),te())}else{if(p==="twinkle"&&u<1&&(w++,w<24?u=.85:w<48?u=.92:u=1),p==="ripple"&&u<1){if(w++,w<4)u=.78;else if(w<8)u=.92;else if(u=1,o){for(let m=0;m<3;m++)k.push({x:o.x,y:o.y,vx:0,vy:0,life:1,color:`hsl(${Math.random()*360}, 70%, 50%)`,size:5+m*10,type:"ripple",headDist:0,tailDist:0,maxDist:0,tailProgress:0});o=null}}p==="twinkle"&&u<1?t.drawImage(_,i-25,h-25,50*u,50*u):t.drawImage(_,e-l/2,n-l/2,l,l),de(),me()}x&&P.push(s.toDataURL("image/png")),A=requestAnimationFrame(ae)}function ge(){x=!0,I=!0,P.length=0,k=[],i=s.width/2,h=s.height/2,Z(i,h),ae()}function pe(){x=!1,I=!1,A&&cancelAnimationFrame(A),we()}async function ye(){await D.load({coreURL:await G(`${J}/ffmpeg-core.js`,"text/javascript"),wasmURL:await G(`${J}/ffmpeg-core.wasm`,"application/wasm"),workerURL:await G(`${J}/ffmpeg-core.worker.js`,"text/javascript")})}async function ve(){s=document.getElementById("my_canvas"),t=s.getContext("2d"),_=new Image,_.src=ze,P.length=0,s.width=300,s.height=300,await new Promise(e=>{_.complete?e(null):_.onload=()=>e(null)}),i=s.width/2,h=s.height/2,t.drawImage(_,i-25,h-25,50,50)}async function we(){async function e(n){return fetch(n).then(async l=>await l.arrayBuffer())}b=P.length,D.on("log",({type:n,message:l})=>{console.warn(`[ffmpeg ${n}] ${l}`);const m=l.match(/frame=\s*(\d+)/);m&&Math.min(100,Math.round(parseInt(m[1])/b*100))});try{for(let S=0;S<P.length;S++){const R=`frame${S.toString().padStart(5,"0")}.png`,j=await e(P[S]),g=new Uint8Array(j);await D.writeFile(R,g)}await D.exec(["-framerate","60","-i","frame%05d.png","-c:v","libx264","-preset","slow","-crf","18","-c:a","aac","-b:a","192k","-pix_fmt","yuv420p","-vf","scale=trunc(iw/2)*2:trunc(ih/2)*2:flags=lanczos","-color_range","tv","-vsync","0","-r","60","-shortest","output.mp4"]);const n=await D.readFile("output.mp4"),l=new Blob([n],{type:"video/mp4"}),m=URL.createObjectURL(l),M=document.createElement("a");M.href=m,M.download="myVideo.mp4",M.click(),URL.revokeObjectURL(m),P.length=0}catch(n){console.error(n),P.length=0}}function _e(){p=Fe(this),y(0,p),y(1,B)}return[p,B,ge,pe,_e]}class He extends Te{constructor(a){super(),Ue(this,a,je,Ae,Se,{},null,[-1,-1])}}export{He as component};
