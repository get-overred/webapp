import{s as N,n as J,d as z,p as s,u as f,i as O,b as X,c as W,e as K,h as D,w as Y,K as L}from"./DweVjaGk.js";import{S as Z,i as v}from"./BA73HWMz.js";const oe="lcmocoacjelocjnhnncinnjaadekagbo",_e="agedonogdeegimiglfjlchknomkdhjhb",p=""+new URL("../assets/cursor.CeMU_J93.png",import.meta.url).href;function x(i){let r,e,c,l;return{c(){r=D("img"),this.h()},l(o){r=W(o,"IMG",{id:!0,alt:!0,src:!0,style:!0}),this.h()},h(){s(r,"id",e="image_"+i[1]+"_backdrop"),s(r,"alt",c="image_"+i[1]+"_backdrop"),L(r.src,l=i[0])||s(r,"src",l),f(r,"width","100%"),f(r,"height","auto")},m(o,_){O(o,r,_)},p(o,_){_&2&&e!==(e="image_"+o[1]+"_backdrop")&&s(r,"id",e),_&2&&c!==(c="image_"+o[1]+"_backdrop")&&s(r,"alt",c),_&1&&!L(r.src,l=o[0])&&s(r,"src",l)},d(o){o&&z(r)}}}function $(i){let r,e,c,l;return{c(){r=D("img"),this.h()},l(o){r=W(o,"IMG",{id:!0,alt:!0,src:!0,style:!0}),this.h()},h(){s(r,"id",e="image_"+i[1]),s(r,"alt",c="image_"+i[1]),L(r.src,l=i[6])||s(r,"src",l),f(r,"width","100%"),f(r,"height","auto")},m(o,_){O(o,r,_)},p(o,_){_&2&&e!==(e="image_"+o[1])&&s(r,"id",e),_&2&&c!==(c="image_"+o[1])&&s(r,"alt",c),_&64&&!L(r.src,l=o[6])&&s(r,"src",l)},d(o){o&&z(r)}}}function ee(i){let r,e,c,l;function o(d,g){return d[6]?$:x}let _=o(i),n=_(i);return{c(){r=D("div"),e=D("div"),n.c(),this.h()},l(d){r=W(d,"DIV",{class:!0});var g=K(r);e=W(g,"DIV",{id:!0,"aria-label":!0,role:!0,style:!0,class:!0});var b=K(e);n.l(b),b.forEach(z),g.forEach(z),this.h()},h(){s(e,"id",c="image_wrapper_"+i[1]),s(e,"aria-label",l="image_wrapper_"+i[1]),s(e,"role","img"),f(e,"border-radius",i[2]+"px"),f(e,"width",i[3]+"%"),f(e,"border",i[4]?i[5]:"none"),s(e,"class","image__wrapper w-[50%] rounded-sm flex justify-center items-center size-min object-contain overflow-clip"),s(r,"class","w-full flex justify-center items-center")},m(d,g){O(d,r,g),X(r,e),n.m(e,null)},p(d,[g]){_===(_=o(d))&&n?n.p(d,g):(n.d(1),n=_(d),n&&(n.c(),n.m(e,null))),g&2&&c!==(c="image_wrapper_"+d[1])&&s(e,"id",c),g&2&&l!==(l="image_wrapper_"+d[1])&&s(e,"aria-label",l),g&4&&f(e,"border-radius",d[2]+"px"),g&8&&f(e,"width",d[3]+"%"),g&48&&f(e,"border",d[4]?d[5]:"none")},i:J,o:J,d(d){d&&z(r),n.d()}}}const j=10,re=3;function te(i,r,e){let{base64:c}=r,{targetData:l}=r,{id:o}=r,{target_bg_color:_}=r,{target_border_radius:n}=r,{target_no_fillout:d}=r,{target_replace_cursor:g}=r,{target_enable_arrow:b}=r,{image_border_radius:h}=r,{target_scale_factor:w}=r,{image_size_perc:y}=r,{image_border_show:B}=r,{border:R}=r,{targetBlob:T}=r,{targetBlobWithBorder:C}=r,U,M=0,a=new Set,u=0,I,S=null,q=0,G=0,H=0,V=0;Y(()=>{c&&l&&(Q(),P(),F())});function P(){I=new Worker(new URL(""+new URL("../workers/screenshot.worker-DcIWm7FH.js",import.meta.url).href,import.meta.url)),I.onmessage=t=>{const{blob:m,blobWithBorder:k}=t.data;e(6,S=null),e(6,S=URL.createObjectURL(m)),e(8,T=URL.createObjectURL(m)),e(9,C=URL.createObjectURL(B?k:m))}}async function F(){if(console.log("updateCanvas ..."),!!I)try{const m=await(await fetch(p)).blob(),k=await createImageBitmap(m,{resizeQuality:"high",resizeWidth:75,resizeHeight:75}),E=await createImageBitmap(await fetch(c).then(A=>A.blob()));I.postMessage({backdropBitmap:E,cursorBitmap:k,targetData:l,options:{target_bg_color:_,target_border_radius:n,target_no_fillout:d,target_replace_cursor:g,target_enable_arrow:b,image_border_radius:h,target_scale_factor:w,image_size_perc:y,_overlay_x:H,_overlay_y:V,_overlay_width:q,_overlay_height:G,_strokeWidth:re,border:R}})}catch(t){console.error("Error creating image bitmaps:",t)}}function Q(){H=l.left-j,V=l.top-j,q=l.width+j*2,G=l.height+j*2}return i.$$set=t=>{"base64"in t&&e(0,c=t.base64),"targetData"in t&&e(10,l=t.targetData),"id"in t&&e(1,o=t.id),"target_bg_color"in t&&e(7,_=t.target_bg_color),"target_border_radius"in t&&e(11,n=t.target_border_radius),"target_no_fillout"in t&&e(12,d=t.target_no_fillout),"target_replace_cursor"in t&&e(13,g=t.target_replace_cursor),"target_enable_arrow"in t&&e(14,b=t.target_enable_arrow),"image_border_radius"in t&&e(2,h=t.image_border_radius),"target_scale_factor"in t&&e(15,w=t.target_scale_factor),"image_size_perc"in t&&e(3,y=t.image_size_perc),"image_border_show"in t&&e(4,B=t.image_border_show),"border"in t&&e(5,R=t.border),"targetBlob"in t&&e(8,T=t.targetBlob),"targetBlobWithBorder"in t&&e(9,C=t.targetBlobWithBorder)},i.$$.update=()=>{if(i.$$.dirty&128&&_){if(!_.startsWith("rgba")){const t=_.replace("#",""),m=parseInt(t.substring(0,2),16),k=parseInt(t.substring(2,4),16),E=parseInt(t.substring(4,6),16);e(7,_=`rgba(${m}, ${k}, ${E}, 1)`)}a.add("bg_color"),e(18,u=a.size)}if(i.$$.dirty&2048&&n&&(a.add("border_radius"),e(18,u=a.size)),i.$$.dirty&4096&&(a.add("no_fillout"),e(18,u=a.size)),i.$$.dirty&8192&&(a.add("replace_cursor"),e(18,u=a.size)),i.$$.dirty&16384&&(a.add("enable_arrow"),e(18,u=a.size)),i.$$.dirty&4&&h&&(a.add("image_border_radius"),e(18,u=a.size)),i.$$.dirty&32768&&w&&(a.add("scale_factor"),e(18,u=a.size)),i.$$.dirty&8&&y&&(a.add("size_perc"),e(18,u=a.size)),i.$$.dirty&16&&B&&(a.add("image_border_show"),e(18,u=a.size)),i.$$.dirty&458752&&u>0){console.log("pendingUpdate size > 0 ");const t=e(17,++M);U&&clearTimeout(U),e(16,U=setTimeout(()=>{t===M&&(F(),a.clear(),e(18,u=0))},250))}i.$$.dirty&128&&_&&a.add("bg_color"),i.$$.dirty&2048&&n&&a.add("border_radius"),i.$$.dirty&4096&&d&&a.add("no_fillout"),i.$$.dirty&8192&&g&&a.add("replace_cursor"),i.$$.dirty&16384&&b&&a.add("enable_arrow"),i.$$.dirty&4&&h&&a.add("image_border_radius"),i.$$.dirty&32768&&w&&a.add("scale_factor"),i.$$.dirty&8&&y&&a.add("size_perc")},console.log("pendingUpdates: ",a),[c,o,h,y,B,R,S,_,T,C,l,n,d,g,b,w,U,M,u]}class le extends Z{constructor(r){super(),v(this,r,te,ee,N,{base64:0,targetData:10,id:1,target_bg_color:7,target_border_radius:11,target_no_fillout:12,target_replace_cursor:13,target_enable_arrow:14,image_border_radius:2,target_scale_factor:15,image_size_perc:3,image_border_show:4,border:5,targetBlob:8,targetBlobWithBorder:9})}}export{oe as I,le as S,_e as d};
